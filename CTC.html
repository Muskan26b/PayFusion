<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>PayFusion </title>
    <meta content="" name="description">
    <meta content="" name="keywords">

    <!-- Favicons -->
    <link href="assets/img/favicon.png" rel="icon">
    <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Google Fonts -->
    <link href="https://fonts.gstatic.com" rel="preconnect">
    <link
        href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
        rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="assets/vendor/quill/quill.snow.css" rel="stylesheet">
    <link href="assets/vendor/quill/quill.bubble.css" rel="stylesheet">
    <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
    <link href="assets/vendor/simple-datatables/style.css" rel="stylesheet">

    <!-- Template Main CSS File -->
    <link href="assets/css/style.css" rel="stylesheet">



</head>

<body>

    <!-- ======= Header ======= -->
    <header id="header" class="header fixed-top d-flex align-items-center  bg-dark">
        <!-- Navbar content -->

        <div class="d-flex align-items-center justify-content-between">
            <a href="index.html" class="logo d-flex align-items-center">
                <img src="assets/img/logo.png" alt="">
                <span class="d-none d-lg-block"> PayFusion</span>
            </a>
            <i class="bi bi-list toggle-sidebar-btn" ></i>
        </div><!-- End Logo -->

        <div class="search-bar">
            <form class="search-form d-flex align-items-center" method="POST" action="#">
                <input type="text" name="query" placeholder="Search" title="Enter search keyword">
                <button type="submit" title="Search"><i class="bi bi-search"></i></button>
            </form>
        </div><!-- End Search Bar -->

        <nav class="header-nav ms-auto">
            <ul class="d-flex align-items-center">

                <li class="nav-item d-block d-lg-none">
                    <a class="nav-link nav-icon search-bar-toggle " href="#">
                        <i class="bi bi-search"></i>
                    </a>
                </li><!-- End Search Icon-->

                <li class="nav-item dropdown">

                    <a class="nav-link nav-icon" href="#" data-bs-toggle="dropdown">
                        <i class="bi bi-bell"></i>
                        <span class="badge bg-primary badge-number">4</span>
                    </a><!-- End Notification Icon -->

                    <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow notifications">
                        <li class="dropdown-header">
                            You have 4 new notifications
                            <a href="#"><span class="badge rounded-pill bg-primary p-2 ms-2">View all</span></a>
                        </li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>

                        <li class="notification-item">
                            <i class="bi bi-exclamation-circle text-warning"></i>
                            <div>
                                <h4>Lorem Ipsum</h4>
                                <p>Quae dolorem earum veritatis oditseno</p>
                                <p>30 min. ago</p>
                            </div>
                        </li>

                        <li>
                            <hr class="dropdown-divider">
                        </li>

                        <li class="notification-item">
                            <i class="bi bi-x-circle text-danger"></i>
                            <div>
                                <h4>Atque rerum nesciunt</h4>
                                <p>Quae dolorem earum veritatis oditseno</p>
                                <p>1 hr. ago</p>
                            </div>
                        </li>

                        <li>
                            <hr class="dropdown-divider">
                        </li>

                        <li class="notification-item">
                            <i class="bi bi-check-circle text-success"></i>
                            <div>
                                <h4>Sit rerum fuga</h4>
                                <p>Quae dolorem earum veritatis oditseno</p>
                                <p>2 hrs. ago</p>
                            </div>
                        </li>

                        <li>
                            <hr class="dropdown-divider">
                        </li>

                        <li class="notification-item">
                            <i class="bi bi-info-circle text-primary"></i>
                            <div>
                                <h4>Dicta reprehenderit</h4>
                                <p>Quae dolorem earum veritatis oditseno</p>
                                <p>4 hrs. ago</p>
                            </div>
                        </li>

                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li class="dropdown-footer">
                            <a href="#">Show all notifications</a>
                        </li>

                    </ul><!-- End Notification Dropdown Items -->

                </li><!-- End Notification Nav -->

                <li class="nav-item dropdown">

                    <a class="nav-link nav-icon" href="#" data-bs-toggle="dropdown">
                        <i class="bi bi-chat-left-text"></i>
                        <span class="badge bg-success badge-number">3</span>
                    </a><!-- End Messages Icon -->

                    <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow messages">
                        <li class="dropdown-header">
                            You have 3 new messages
                            <a href="#"><span class="badge rounded-pill bg-primary p-2 ms-2">View all</span></a>
                        </li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>

                        <li class="message-item">
                            <a href="#">
                                <img src="assets/img/messages-1.jpg" alt="" class="rounded-circle">
                                <div>
                                    <h4>Maria Hudson</h4>
                                    <p>Velit asperiores et ducimus soluta repudiandae labore officia est ut...</p>
                                    <p>4 hrs. ago</p>
                                </div>
                            </a>
                        </li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>

                        <li class="message-item">
                            <a href="#">
                                <img src="assets/img/messages-2.jpg" alt="" class="rounded-circle">
                                <div>
                                    <h4>Anna Nelson</h4>
                                    <p>Velit asperiores et ducimus soluta repudiandae labore officia est ut...</p>
                                    <p>6 hrs. ago</p>
                                </div>
                            </a>
                        </li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>

                        <li class="message-item">
                            <a href="#">
                                <img src="assets/img/messages-3.jpg" alt="" class="rounded-circle">
                                <div>
                                    <h4>David Muldon</h4>
                                    <p>Velit asperiores et ducimus soluta repudiandae labore officia est ut...</p>
                                    <p>8 hrs. ago</p>
                                </div>
                            </a>
                        </li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>

                        <li class="dropdown-footer">
                            <a href="#">Show all messages</a>
                        </li>

                    </ul><!-- End Messages Dropdown Items -->

                </li><!-- End Messages Nav -->

                <li class="nav-item dropdown pe-3">

                    <a class="nav-link nav-profile d-flex align-items-center pe-0" href="#" data-bs-toggle="dropdown">
                        <img id="nav-profile-img" src="assets/img/profile-img.jpg" alt="Profile" class="rounded-circle">
                        <span class="d-none d-md-block dropdown-toggle ps-2" id="nav-profile-name"></span>
                    </a><!-- End Profile Iamge Icon -->

                    <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow profile">
                        <li class="dropdown-header">
                            <h6><span id="nav-pro-name"></span></h6>
                            <span id="nav-designation"></span>
                        </li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li>
                            <a class="dropdown-item d-flex align-items-center" href="profile.html">
                                <i class="bi bi-person"></i>
                                <span>My Profile</span>
                            </a>
                        </li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li>
                            <a class="dropdown-item d-flex align-items-center" id="account-settings"
                                href="profile.html?activeTab=edit">
                                <i class="bi bi-gear"></i>
                                <span>Profile Settings</span>
                            </a>
                        </li>
                        
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li>
                            <a class="dropdown-item d-flex align-items-center" href="#">
                                <i class="bi bi-box-arrow-right"></i>
                                <span>Sign Out</span>
                            </a>
                        </li>
                    </ul><!-- End Profile Dropdown Items -->
                </li><!-- End Profile Nav -->
            </ul>
        </nav><!-- End Icons Navigation -->
    </header><!-- End Header -->

    <!-- ======= Sidebar ======= -->
    <aside id="sidebar" class="sidebar">

        <ul class="sidebar-nav" id="sidebar-nav">
            <li class="nav-item">
                <a class="nav-link collapsed" href="index.html">
                    <i class="bi bi-grid"></i>
                    <span>Dashboard</span>
                </a>
            </li><!-- End Dashboard Nav -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="employee.html">
                    <i class="bi bi-card-list"></i>
                    <span>Employee Master</span>
                </a>
            </li><!-- End Employee Nav -->
            <li class="nav-item">
                <a class="nav-link active" href="CTC.html">
                    <i class="bi bi-card-list"></i>
                    <span>CTC Master</span>
                </a>
            </li><!-- End CTC Nav -->
            <li class="nav-item">
                <a class="nav-link collapsed " href="attendance.html">
                    <i class="bi bi-card-list"></i>
                    <span>Attendance Master</span>
                </a>
            </li><!-- End Attendance Nav -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="payroll.html">
                    <i class="bi bi-card-list"></i>
                    <span>Payroll Master</span>
                </a>
            </li><!-- End Payroll Nav -->
            <li class="nav-item">
                <a class="nav-link collapsed " href="year.html">
                    <i class="bi bi-card-list"></i>
                    <span>Year Master</span>
                </a>
            </li><!-- End Year Nav -->

            <li class="nav-heading">Pages</li>
            <li class="nav-item">
                <a class="nav-link collapsed" href="profile.html">
                    <i class="bi bi-person"></i>
                    <span>Profile</span>
                </a>
            </li><!-- End Profile Page Nav -->

            <li class="nav-item">
                <a class="nav-link collapsed" href="register.html">
                    <i class="bi bi-card-list"></i>
                    <span>Register</span>
                </a>
            </li><!-- End Register Page Nav -->

            <li class="nav-item">
                <a class="nav-link collapsed" href="login.html">
                    <i class="bi bi-box-arrow-in-right"></i>
                    <span>Login</span>
                </a>
            </li><!-- End Login Page Nav -->
        </ul>
    </aside><!-- End Sidebar-->

    <main id="main" class="main">
        <div class="pagetitle">
            <h1>CTC Master</h1>
            <nav>
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                    <li class="breadcrumb-item active">CTC Master</li>
                </ol>
            </nav>
        </div><!-- End Page Title -->

        <div class="card">
            <div class="card-body">
                <h5 class="card-title">CTC Information</h5>

                <!-- Multi Columns Form -->
                <form class="row g-3" id="myForm">
                    <div class="col-md-12">
                        <label for="empcode" class="form-label">Employee Code</label>
                        <input type="text" class="form-control" id="empcode">
                    </div>
                    <div class="col-md-6">
                        <label for="Year" class="form-label">Yearly CTC</label>
                        <input type="number" class="form-control" id="Year" required>
                    </div>
                    <div class="col-md-6">
                        <label for="Month" class="form-label">Monthly CTC</label>
                        <input type="number" class="form-control" id="Month" required>
                    </div>
                    <div class="col-md-6">
                        <label for="Salary" class="form-label">Basic Salary</label>
                        <input type="number" class="form-control" id="Salary" required>
                    </div>
                    <div class="col-md-6">
                        <label for="HRA" class="form-label">HRA</label>
                        <input type="number" class="form-control" id="HRA" required>
                    </div>
                    <div class="col-md-6">
                        <label for="create" class="form-label">Created By</label>
                        <input type="text" class="form-control" id="create" required>
                    </div>
                    <div class="col-md-6">
                        <label for="createdate" class="form-label">Created Date</label>
                        <input type="date" class="form-control" id="createdate" required>
                    </div>
                    <div class="col-md-6">
                        <label for="modify" class="form-label">Modified By</label>
                        <input type="text" class="form-control" id="modify" required>
                    </div>
                    <div class="col-md-6">
                        <label for="modifydate" class="form-label">Modified Date</label>
                        <input type="date" class="form-control" id="modifydate" required>
                    </div>
                    <div> <input type="file" id="fileInput" accept=".xlsx, .xls"></div>

                    <div class="text-center">
                        <button id="submit" type="submit" class="btn btn-primary submit">Submit</button>
                        <button type="reset" class="btn btn-secondary">Reset</button>
                    </div>
                </form>
                <!-- <div id="fileNameDisplay"></div>-->
                <div id="excelData"></div> <!-- Container for displaying Excel data -->
            </div>

            <div>
                <p id="popupText" class="popupText" style="display: none;">Data submitted successfully!</p>
            </div>

            <div class="table-container">
                <table class="table" id="ctcdataTable" style="display: table; margin-top: 30px;">
                    <thead class="custom-header" style="visibility: hidden;">
                        <tr class="th,td">
                            <th>Employee Code</th>
                            <th>Yearly CTC</th>
                            <th>Monthly CTC</th>
                            <th>Basic Salary</th>
                            <th>HRA</th>
                            <th>Created By</th>
                            <th>Create Date</th>
                            <th>Modified By</th>
                            <th>Modified Date</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="dataTableBody"></tbody>
                </table>
                <input type="hidden" id="rowData" name="rowData">

            </div>
        </div>

    </main><!-- End #main -->

    <!-- ======= Footer ======= -->
    <footer id="footer" class="footer">
        <div class="copyright">
            &copy; Copyright <strong><span>PayFusion</span></strong>. All Rights Reserved
        </div>
    </footer><!-- End Footer -->

    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
            class="bi bi-arrow-up-short"></i></a>

    <!-- Vendor JS Files -->
    <script src="assets/vendor/apexcharts/apexcharts.min.js"></script>
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/vendor/chart.js/chart.umd.js"></script>
    <script src="assets/vendor/echarts/echarts.min.js"></script>
    <script src="assets/vendor/quill/quill.min.js"></script>
    <script src="assets/vendor/simple-datatables/simple-datatables.js"></script>
    <script src="assets/vendor/tinymce/tinymce.min.js"></script>
    <script src="assets/vendor/php-email-form/validate.js"></script>

    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/7.14.1-0/firebase.js"></script>-->

    <!--for excel import-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>


    <!-- Template Main JS File -->
    <script src="assets/js/main.js"></script>



    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-app.js";
        import { getDatabase, ref, set, get, child, onValue, remove } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-database.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.9.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBFZCp7QTt-aP7DbuNVepmy8hZWAFeLQ5M",
            authDomain: "payfusion-project.firebaseapp.com",
            databaseURL: "https://payfusion-project-default-rtdb.firebaseio.com",
            projectId: "payfusion-project",
            storageBucket: "payfusion-project.appspot.com",
            messagingSenderId: "1000636166254",
            appId: "1:1000636166254:web:f7b1ae682735533978367f"
        };

        // initailize firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth();
        const database = getDatabase(app);


        document.addEventListener('DOMContentLoaded', () => {
            const tableHeader = document.querySelector('.custom-header');
            tableHeader.style.visibility = 'hidden'; // Initially hide the table header

            // Retrieve the data for the current user
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    const userEmail = user.email;
                    const userRef = ref(database, `payfusion/Register record/${userEmail.replace(/[.#$[\]]/g, "_")}`);

                    // Fetch the user data and display it in the profile page
                    onValue(userRef, (snapshot) => {
                        if (snapshot.exists()) {
                            const userData = snapshot.val();
                            document.getElementById('nav-profile-name').textContent = userData.name;
                            document.getElementById('nav-pro-name').textContent = userData.name;
                            document.getElementById('nav-designation').textContent = userData.designation;

                        } else {
                            console.log('No data available for this user.');
                        }
                    });

                } else {
                    console.log('No user is signed in.');
                }
            });

            //-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


            const fileInput = document.getElementById('fileInput');
            const dataTableBody = document.getElementById('dataTableBody');

            // Load data from Firebase when the page loads
            window.onload = () => {
                loadDataFromFirebase();
            };

            // Function to load data from Firebase
            function loadDataFromFirebase() {
                onValue(ref(database, 'payfusion/CTC master'), (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        // Convert object into an array of rows
                        const dataArray = Object.values(data).map(empData => [
                            empData.empcode,
                            empData.Year,
                            empData.Month,
                            empData.Salary,
                            empData.HRA,
                            empData.create,
                            empData.createdate,
                            empData.modify,
                            empData.modifydate
                        ]);
                        renderTableData(dataArray);
                        // Make table header visible after data is loaded
                        tableHeader.style.visibility = 'visible';
                    } else {
                        // Clear the table body and hide the table header
                        dataTableBody.innerHTML = '';
                        tableHeader.style.visibility = 'hidden';
                    }
                });
            }

            // Function to render table data
            function renderTableData(data) {
                dataTableBody.innerHTML = '';
                if (Array.isArray(data)) { // Check if data is an array
                    data.forEach((rowData) => {
                        const rowElement = document.createElement('tr');

                        rowData.forEach((cell) => {
                            const cellElement = document.createElement('td');
                            cellElement.textContent = cell;
                            rowElement.appendChild(cellElement);
                        });
                        const actionCell = document.createElement('td');

                        // Create a container div for the buttons
                        const buttonContainer = document.createElement('div');
                        buttonContainer.classList.add('button-container');

                        const editButton = document.createElement('button');
                        editButton.textContent = 'Edit';
                        editButton.classList.add('editBtn');
                        editButton.addEventListener('click', () => handleEdit(rowData));

                        const deleteButton = document.createElement('button');
                        deleteButton.textContent = 'Delete';
                        deleteButton.classList.add('deleteBtn');
                        deleteButton.addEventListener('click', () => handleDelete(rowData));

                        buttonContainer.appendChild(editButton);
                        buttonContainer.appendChild(deleteButton);
                        actionCell.appendChild(buttonContainer);
                        rowElement.appendChild(actionCell);

                        dataTableBody.appendChild(rowElement);
                    });
                } else {
                    console.error('data is not an array:', data);
                }
            }

            // Function to handle edit button click
            function handleEdit(rowData) {
                document.getElementById('empcode').value = rowData[0] || '';
                document.getElementById('Year').value = rowData[1] || '';
                document.getElementById('Month').value = rowData[2] || '';
                document.getElementById('Salary').value = rowData[3] || '';
                document.getElementById('HRA').value = rowData[4] || '';
                document.getElementById('create').value = rowData[5] || '';
                document.getElementById('createdate').value = rowData[6] || '';
                document.getElementById('modify').value = rowData[7] || '';
                document.getElementById('modifydate').value = rowData[8] || '';

                // Scroll to the top of the page
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            }

            // Function to handle delete button click
            function handleDelete(rowData) {
                const confirmation = window.confirm('Are you sure you want to delete this row?');
                if (confirmation) {
                    // Remove data from Firebase
                    const empCode = rowData[0]; // Assuming empcode is in the 5th column
                    const empRef = ref(database, 'payfusion/CTC master/emp-' + empCode);
                    remove(empRef);
                }
            }



            fileInput.addEventListener('change', (event) => {
                const file = event.target.files[0];

                const reader = new FileReader();
                reader.onload = (event) => {
                    const data = event.target.result;
                    const workbook = XLSX.read(data, { type: 'binary' });
                    const sheetName = workbook.SheetNames[1];
                    const worksheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });

                    dataTableBody.innerHTML = '';
                    for (let i = 1; i < jsonData.length; i++) { // Starting from the second row
                        const row = jsonData[i];
                        const rowElement = document.createElement('tr');

                        row.forEach((cell) => {
                            const cellElement = document.createElement('td');
                            cellElement.textContent = cell;
                            rowElement.appendChild(cellElement);
                        });
                        dataTableBody.appendChild(rowElement);
                    }
                    tableHeader.style.visibility = 'visible'; // Make table header visible after upload

                    // Store visibility flag in local storage
                    localStorage.setItem('tableHeaderVisibility', 'visible');

                    // Store data in Firebase
                    storeDataInFirebase(jsonData.slice(1)); // Slice to exclude the header row
                };
                reader.readAsBinaryString(file);
            });

            // Function to store data in Firebase
            function storeDataInFirebase(data) {
                data.forEach((rowData) => {
                    const empCode = rowData[0]; // Assuming empcode is in the 5th column
                    const empRef = ref(database, 'payfusion/CTC master/emp-' + empCode);
                    set(empRef, {
                        empcode: rowData[0],
                        Year: rowData[1],
                        Month: rowData[2],
                        Salary: rowData[3],
                        HRA: rowData[4],
                        create: rowData[5],
                        createdate: rowData[6],
                        modify: rowData[7],
                        modifydate: rowData[8]
                    });
                });
            }


            document.getElementById('myForm').addEventListener('submit', (event) => {
                event.preventDefault();
                const modifiedData = [
                    document.getElementById('empcode').value,
                    document.getElementById('Year').value,
                    document.getElementById('Month').value,
                    document.getElementById('Salary').value,
                    document.getElementById('HRA').value,
                    document.getElementById('create').value,
                    document.getElementById('createdate').value,
                    document.getElementById('modify').value,
                    document.getElementById('modifydate').value
                ];


                // Get the empcode from the form field
                const updatedEmpCode = document.getElementById('empcode').value;

                // Find the row in the table where the empcode matches the updatedEmpCode
                const rows = dataTableBody.querySelectorAll('tr');
                let rowToUpdate;
                rows.forEach((row) => {
                    const cells = row.querySelectorAll('td');
                    if (cells[0].textContent === updatedEmpCode) { // Assuming empcode is in the 1th column (index 4)
                        rowToUpdate = row;
                    }
                });
                if (rowToUpdate) {
                    const cells = rowToUpdate.querySelectorAll('td');
                    modifiedData.forEach((value, index) => {
                        cells[index].textContent = value || '';
                    });

                    // Update data in Firebase
                    const empRef = ref(database, 'payfusion/CTC master/emp-' + updatedEmpCode);
                    set(empRef, {
                        empcode: modifiedData[0],
                        Year: modifiedData[1],
                        Month: modifiedData[2],
                        Salary: modifiedData[3],
                        HRA: modifiedData[4],
                        create: modifiedData[5],
                        createdate: modifiedData[6],
                        modify: modifiedData[7],
                        modifydate: modifiedData[8]
                    });
                } else {
                    // Add new row for new data
                    const newRow = document.createElement('tr');
                    modifiedData.forEach((value) => {
                        const newCell = document.createElement('td');
                        newCell.textContent = value || '';
                        newRow.appendChild(newCell);
                    });
                    const actionCell = document.createElement('td');

                    // Create a container div for the buttons
                    const buttonContainer = document.createElement('div');
                    buttonContainer.classList.add('button-container');

                    const editButton = document.createElement('button');
                    editButton.textContent = 'Edit';
                    editButton.classList.add('editBtn');
                    editButton.addEventListener('click', () => handleEdit(rowData));

                    const deleteButton = document.createElement('button');
                    deleteButton.textContent = 'Delete';
                    deleteButton.classList.add('deleteBtn');
                    deleteButton.addEventListener('click', () => handleDelete(rowData));

                    buttonContainer.appendChild(editButton);
                    buttonContainer.appendChild(deleteButton);
                    actionCell.appendChild(buttonContainer);
                    newRow.appendChild(actionCell);

                    dataTableBody.appendChild(newRow);

                    // Store new data in Firebase
                    const empRef = ref(database, 'payfusion/CTC master/emp-' + updatedEmpCode);
                    set(empRef, {
                        empcode: modifiedData[0],
                        Year: modifiedData[1],
                        Month: modifiedData[2],
                        Salary: modifiedData[3],
                        HRA: modifiedData[4],
                        create: modifiedData[5],
                        createdate: modifiedData[6],
                        modify: modifiedData[7],
                        modifydate: modifiedData[8]
                    });
                }

                // Reset the form fields
                document.getElementById('myForm').reset();
            });


            //------------------navbar profile-------------------------------------------------------------           
            window.addEventListener('load', function () {
                const savedImage = localStorage.getItem('profileImage');
                if (savedImage) {
                    document.getElementById('nav-profile-img').src = savedImage;
                }
            });
            // Handle file input change event
            document.getElementById('profileImage').addEventListener('change', function (event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        // Update image sources
                        const imageData = e.target.result;
                        document.getElementById('nav-profile-img').src = imageData;

                        // Save the image data to local storage
                        localStorage.setItem('profileImage', imageData);
                    };
                    reader.readAsDataURL(file);
                }
            });
            // Function to remove profile image
            function removeProfileImage() {
                // Update image sources to the default image
                document.getElementById('nav-profile-img').src = '';

                // Remove the image data from local storage
                localStorage.removeItem('profileImage');
            }

            // Handle click event for "Remove my profile image"
            document.querySelector('.btn-danger').addEventListener('click', function (event) {
                event.preventDefault(); // Prevent the default behavior of the anchor element
                removeProfileImage();
            });


            
        });



    </script>

</body>

</html>